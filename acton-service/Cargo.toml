[package]
name = "acton-service"
version.workspace = true
edition.workspace = true
authors.workspace = true
license.workspace = true
description = "Production-ready Rust microservice framework with type-enforced API versioning"
repository = "https://github.com/Govcraft/acton-service"
homepage = "https://github.com/Govcraft/acton-service"
documentation = "https://docs.rs/acton-service"
readme = "../README.md"
keywords = ["microservice", "framework", "grpc", "rest", "versioning"]
categories = ["web-programming::http-server", "asynchronous", "network-programming"]

[dependencies]
# Async runtime
tokio = { workspace = true }
tokio-stream = { workspace = true, optional = true }

# HTTP framework
axum = { workspace = true }
tower = { workspace = true }
tower-http = { workspace = true }

# Tower resilience and middleware (optional)
tower-resilience = { workspace = true, optional = true }
tower-otel-http-metrics = { workspace = true, optional = true }
tower_governor = { workspace = true, optional = true }

# gRPC framework (optional)
tonic = { workspace = true, optional = true }
prost = { workspace = true, optional = true }
tonic-prost = { workspace = true, optional = true }
tonic-build = { workspace = true, optional = true }
prost-build = { version = "0.14.1", optional = true }
tonic-prost-build = { workspace = true, optional = true }

# Database (optional)
sqlx = { workspace = true, optional = true }

# Redis (optional)
redis = { workspace = true, optional = true }
deadpool-redis = { workspace = true, optional = true }

# NATS (optional)
async-nats = { workspace = true, optional = true }

# JWT
jsonwebtoken = { workspace = true }

# Serialization
serde = { workspace = true }
serde_json = { workspace = true }

# Configuration
figment = { workspace = true }

# Tracing
tracing = { workspace = true }
tracing-subscriber = { workspace = true }
opentelemetry = { workspace = true, optional = true }
opentelemetry-otlp = { workspace = true, optional = true }
opentelemetry_sdk = { workspace = true, optional = true }
tracing-opentelemetry = { workspace = true, optional = true }

# Error handling
thiserror = { workspace = true }
anyhow = { workspace = true }

# Time
chrono = { workspace = true }

# UUID
uuid = { workspace = true }

# HTTP client
reqwest = { workspace = true }

# Async utilities
futures = { workspace = true }
async-trait = { workspace = true }

# HTTP types
http = { workspace = true }

# Other dependencies
xdg = "3.0.0"
utoipa = { version = "5.4.0", features = ["axum_extras"], optional = true }
utoipa-swagger-ui = { version = "9.0.2", features = ["axum"], optional = true }
tonic-health = { version = "0.14.2", optional = true }
tonic-reflection = { version = "0.14.2", optional = true }

[features]
default = ["http", "observability"]
http = []
grpc = ["dep:tonic", "dep:prost", "dep:tonic-prost", "dep:tonic-build", "dep:prost-build", "dep:tonic-prost-build", "dep:tokio-stream", "dep:tonic-health", "dep:tonic-reflection"]
database = ["dep:sqlx"]
cache = ["dep:redis", "dep:deadpool-redis"]
events = ["dep:async-nats"]
observability = ["dep:opentelemetry", "dep:opentelemetry-otlp", "dep:opentelemetry_sdk", "dep:tracing-opentelemetry"]
resilience = ["dep:tower-resilience"]
otel-metrics = ["dep:tower-otel-http-metrics", "observability"]
governor = ["dep:tower_governor"]
openapi = ["dep:utoipa", "dep:utoipa-swagger-ui"]
full = ["http", "grpc", "database", "cache", "events", "observability", "resilience", "otel-metrics", "governor", "openapi"]
tonic-health = ["dep:tonic-health"]
tonic-reflection = ["dep:tonic-reflection"]

[[example]]
name = "simple-api"
path = "examples/simple-api.rs"
required-features = ["http"]

[[example]]
name = "users-api"
path = "examples/users-api.rs"
required-features = ["http"]

[[example]]
name = "ping-pong"
path = "examples/ping-pong.rs"
required-features = ["grpc"]

[build-dependencies]
prost-build = "0.14.1"
tonic-build.workspace = true
tonic-prost-build.workspace = true
